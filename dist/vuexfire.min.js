/*!
 * vuexfire v2.1.3.2
 * (c) 2017 Eduardo San Martin Morote
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VuexFire=e.VuexFire||{})}(this,function(e){"use strict";function t(e,t){for(var n=0;n<e.length;n++)if(e[n].$key===t)return n;return-1}function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(e){return"function"==typeof e.key?e.key():e.key}function i(e){return"function"==typeof e.ref?e=e.ref():"object"==typeof e.ref&&(e=e.ref),e}function c(e){var t=e.val(),i=n(t)?t:{".value":t};return i.$key=r(e),i.$ref=e.ref.toString(),i.$priority=e.getPriority(),i.$length=e.numChildren(),i}function o(e){var t=e.key,n=e.source,r=e.cancelCallback,i=e.commit,o=e.state;return{value:n.on("value",function(e){i(d,{type:d,key:t,record:c(e),state:o},A)},r)}}function a(e){var n=e.key,i=e.source,o=e.cancelCallback,a=e.commit,u=e.state;a(l,{type:l,state:u,key:n},A);var s=i.on("child_added",function(e,r){var i=u[n],o=r?t(i,r)+1:0;a(y,{type:y,state:u,key:n,index:o,record:c(e)},A)},o),f=i.on("child_removed",function(e){var i=t(u[n],r(e));a(E,{type:E,state:u,key:n,index:i},A)},o);return{child_added:s,child_changed:i.on("child_changed",function(e){var i=t(u[n],r(e));a(v,{type:v,state:u,key:n,index:i,record:c(e)},A)},o),child_removed:f,child_moved:i.on("child_moved",function(e,i){var o=u[n],s=t(o,r(e)),f=i?t(o,i)+1:0;a(k,{type:k,state:u,key:n,index:s,newIndex:f+=s<f?-1:0,record:c(e)},A)},o)}}function u(e){var t=e.state,r=e.commit,c=e.key,u=e.source,f=e.options,d=f.cancelCallback,l=f.readyCallback;if(!n(u))throw new Error("VuexFire: invalid Firebase binding source.");if(!(c in t))throw new Error("VuexFire: cannot bind undefined property '"+c+"'. Define it on the state first.");var y=_.get(r);y||(y={sources:Object.create(null),listeners:Object.create(null)},_.set(r,y)),c in y.sources&&s({commit:r,key:c}),y.sources[c]=i(u);var v;v=t[c]&&"length"in t[c]?a({key:c,source:u,cancelCallback:d,commit:r,state:t}):o({key:c,source:u,cancelCallback:d,commit:r,state:t}),y.listeners[c]=v,l&&u.once("value",l)}function s(e){var t=e.commit,n=e.key,r=_.get(t);if(r||(r={sources:Object.create(null),listeners:Object.create(null)},_.set(t,r)),!(n in r.sources))throw new Error("VuexFire: cannot unbind '"+n+"' because it wasn't bound.");var i=r.sources[n],c=r.listeners[n];for(var o in c)i.off(o,c[o]);delete r.sources[n],delete r.listeners[n]}function f(e){return function(t,n){var r=t.state,i=t.commit;return t.bindFirebaseRef=function(e,t,n){return void 0===n&&(n={}),u({state:r,commit:i,key:e,source:t,options:n})},t.unbindFirebaseRef=function(e){return s({commit:i,key:e})},e(t,n)}}var d="vuexfire/OBJECT_VALUE",l="VUEXFIRE_ARRAY_INITIALIZE",y="vuexfire/ARRAY_ADD",v="vuexfire/ARRAY_CHANGE",k="vuexfire/ARRAY_MOVE",E="vuexfire/ARRAY_REMOVE",R=Object.freeze({VUEXFIRE_OBJECT_VALUE:d,VUEXFIRE_ARRAY_INITIALIZE:l,VUEXFIRE_ARRAY_ADD:y,VUEXFIRE_ARRAY_CHANGE:v,VUEXFIRE_ARRAY_MOVE:k,VUEXFIRE_ARRAY_REMOVE:E}),b={};b[d]=function(e,t){var n=t.key,r=t.record;e[n]=r},b[l]=function(e,t){e[t.key]=[]},b[y]=function(e,t){var n=t.key,r=t.index,i=t.record;e[n].splice(r,0,i)},b[v]=function(e,t){var n=t.key,r=t.index,i=t.record;e[n].splice(r,1,i)},b[k]=function(e,t){var n=t.key,r=t.index,i=(t.record,t.newIndex),c=e[n];c.splice(i,0,c.splice(r,1)[0])},b[E]=function(e,t){var n=t.key,r=t.index;e[n].splice(r,1)};var p={};Object.keys(R).forEach(function(e){var t=R[e];p[t]=function(e,n){b[t](n.state,n)}});var A={root:!0},_=new WeakMap;e.firebaseMutations=p,e.firebaseAction=f,Object.defineProperty(e,"__esModule",{value:!0})});